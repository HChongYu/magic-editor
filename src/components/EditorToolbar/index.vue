<template>
  <div class="editor-toolbar">
    <!-- åŸºç¡€æ ¼å¼æŒ‰é’®ç»„ -->
    <div class="toolbar-group">
      <button class="toolbar-btn" title="æ ‡é¢˜" @click="toggleHeading">
        <span>H</span>
      </button>
      <button class="toolbar-btn" title="åŠ ç²—" @click="toggleBold" :class="{ active: editor?.isActive('bold') }">
        <span class="icon-bold">B</span>
      </button>
      <button class="toolbar-btn" title="æ–œä½“" @click="toggleItalic" :class="{ active: editor?.isActive('italic') }">
        <span class="icon-italic">I</span>
      </button>
      <button class="toolbar-btn" title="ä¸‹åˆ’çº¿" @click="toggleUnderline" :class="{ active: editor?.isActive('underline') }">
        <span class="icon-underline">U</span>
      </button>
      <button class="toolbar-btn" title="é«˜äº®" @click="toggleHighlight" :class="{ active: editor?.isActive('highlight') }">
        <span class="icon-highlight">âš¡</span>
      </button>
    </div>

    <!-- åˆ—è¡¨æŒ‰é’®ç»„ -->
    <div class="toolbar-group">
      <button class="toolbar-btn" title="æœ‰åºåˆ—è¡¨" @click="toggleOrderedList" :class="{ active: editor?.isActive('orderedList') }">
        <span class="icon-ordered-list">1.</span>
      </button>
      <button class="toolbar-btn" title="æ— åºåˆ—è¡¨" @click="toggleBulletList" :class="{ active: editor?.isActive('bulletList') }">
        <span class="icon-bullet-list">â€¢</span>
      </button>
    </div>

    <!-- å¯¹é½æ–¹å¼æŒ‰é’®ç»„ -->
    <div class="toolbar-group">
      <button class="toolbar-btn" title="å·¦å¯¹é½" @click="setTextAlign('left')" :class="{ active: editor?.isActive({ textAlign: 'left' }) }">
        <span class="icon-align-left">â‰¡</span>
      </button>
      <button class="toolbar-btn" title="å±…ä¸­å¯¹é½" @click="setTextAlign('center')" :class="{ active: editor?.isActive({ textAlign: 'center' }) }">
        <span class="icon-align-center">â‰£</span>
      </button>
      <button class="toolbar-btn" title="å³å¯¹é½" @click="setTextAlign('right')" :class="{ active: editor?.isActive({ textAlign: 'right' }) }">
        <span class="icon-align-right">â‰¡</span>
      </button>
      <button class="toolbar-btn" title="ä¸¤ç«¯å¯¹é½" @click="setTextAlign('justify')" :class="{ active: editor?.isActive({ textAlign: 'justify' }) }">
        <span class="icon-align-justify">â‰£</span>
      </button>
    </div>

    <!-- å¼•ç”¨æŒ‰é’® -->
    <div class="toolbar-group">
      <button class="toolbar-btn" title="å¼•ç”¨" @click="toggleBlockquote" :class="{ active: editor?.isActive('blockquote') }">
        <span class="icon-quote">"</span>
      </button>
    </div>

    <!-- åª’ä½“æ’å…¥æŒ‰é’®ç»„ -->
    <div class="toolbar-group media-group">
      <button class="toolbar-btn" title="å›¾ç‰‡" @click="insertImage">
        <span class="icon-image">ğŸ–¼ï¸</span>
      </button>
      <button class="toolbar-btn" title="è§†é¢‘" @click="insertVideo">
        <span class="icon-video">ğŸ¬</span>
      </button>
      <button class="toolbar-btn" title="è¡¨æƒ…" @click="insertEmoji">
        <span class="icon-emoji">ğŸ˜Š</span>
      </button>
      <button class="toolbar-btn" title="è¡¨æ ¼" @click="insertTable">
        <span class="icon-table">ğŸ“Š</span>
      </button>
    </div>

    <!-- ç‰¹æ®Šå†…å®¹æŒ‰é’®ç»„ -->
    <div class="toolbar-group special-group">
      <button class="toolbar-btn" title="è¡¥å……è¯´æ˜" @click="insertNote">
        <span class="icon-note">è¡¥å……è¯´æ˜</span>
      </button>
      <button class="toolbar-btn" title="æ’å…¥äº®ç‚¹" @click="insertHighlight">
        <span class="icon-highlight-point">æ’å…¥äº®ç‚¹</span>
      </button>
      <button class="toolbar-btn" title="ç”¨è½¦ä¼˜åŠ¿" @click="insertAdvantage">
        <span class="icon-advantage">ç”¨è½¦ä¼˜åŠ¿</span>
      </button>
      <button class="toolbar-btn" title="è”ç³»æ–¹å¼" @click="insertContact">
        <span class="icon-contact">è”ç³»æ–¹å¼</span>
      </button>
    </div>
  </div>
</template>

<script>
export default {
  name: 'EditorToolbar',
  props: {
    editor: {
      type: Object,
      default: null
    }
  },
  methods: {
    // åŸºç¡€æ ¼å¼æ–¹æ³•
    toggleHeading() {
      if (this.editor) {
        this.editor.chain().focus().toggleHeading({ level: 2 }).run()
      }
    },
    toggleBold() {
      if (this.editor) {
        this.editor.chain().focus().toggleBold().run()
      }
    },
    toggleItalic() {
      if (this.editor) {
        this.editor.chain().focus().toggleItalic().run()
      }
    },
    toggleUnderline() {
      if (this.editor) {
        this.editor.chain().focus().toggleUnderline().run()
      }
    },
    toggleHighlight() {
      if (this.editor) {
        this.editor.chain().focus().toggleHighlight().run()
      }
    },

    // åˆ—è¡¨æ–¹æ³•
    toggleOrderedList() {
      if (this.editor) {
        this.editor.chain().focus().toggleOrderedList().run()
      }
    },
    toggleBulletList() {
      if (this.editor) {
        this.editor.chain().focus().toggleBulletList().run()
      }
    },

    // å¯¹é½æ–¹æ³•
    setTextAlign(alignment) {
      if (this.editor) {
        this.editor.chain().focus().setTextAlign(alignment).run()
      }
    },

    // å¼•ç”¨æ–¹æ³•
    toggleBlockquote() {
      if (this.editor) {
        this.editor.chain().focus().toggleBlockquote().run()
      }
    },

    // åª’ä½“æ’å…¥æ–¹æ³•
    insertImage() {
      const url = prompt('è¯·è¾“å…¥å›¾ç‰‡URL')
      if (url && this.editor) {
        this.editor.chain().focus().setImage({ src: url }).run()
      }
    },
    insertVideo() {
      const url = prompt('è¯·è¾“å…¥è§†é¢‘URL')
      if (url && this.editor) {
        // éœ€è¦å®‰è£…è§†é¢‘æ‰©å±•
        this.editor.chain().focus().setVideo({ src: url }).run()
      }
    },
    insertEmoji() {
      // è¿™é‡Œå¯ä»¥å®ç°è¡¨æƒ…é€‰æ‹©é¢æ¿
      if (this.editor) {
        this.editor.chain().focus().insertContent('ğŸ˜Š').run()
      }
    },
    insertTable() {
      if (this.editor) {
        this.editor.chain().focus()
          .insertTable({ rows: 3, cols: 3, withHeaderRow: true })
          .run()
      }
    },

    // ç‰¹æ®Šå†…å®¹æ’å…¥æ–¹æ³•
    insertNote() {
      if (this.editor) {
        this.editor.chain().focus().insertContent('<div class="note">è¡¥å……è¯´æ˜å†…å®¹</div>').run()
      }
    },
    insertHighlight() {
      if (this.editor) {
        // è¿™é‡Œå¯ä»¥æ’å…¥è‡ªå®šä¹‰èŠ‚ç‚¹
        this.editor.chain().focus().insertContent('<div class="highlight-point">äº®ç‚¹å†…å®¹</div>').run()
      }
    },
    insertAdvantage() {
      if (this.editor) {
        this.editor.chain().focus().insertContent('<div class="car-advantage">ç”¨è½¦ä¼˜åŠ¿å†…å®¹</div>').run()
      }
    },
    insertContact() {
      if (this.editor) {
        this.editor.chain().focus().insertContent('<div class="contact-info">è”ç³»æ–¹å¼å†…å®¹</div>').run()
      }
    }
  }
}
</script>

<style scoped>
.editor-toolbar {
  display: flex;
  align-items: center;
  padding: 8px 12px;
  background: #f8f9fa;
  border: 1px solid #e1e5e9;
  border-radius: 6px;
  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);
  gap: 4px;
  flex-wrap: wrap;
  position: relative;
  margin-bottom: 10px;
}

.toolbar-group {
  display: flex;
  align-items: center;
  gap: 2px;
  position: relative;
  border-right: 1px solid #e5e7eb;
  padding-right: 4px;
  margin-right: 4px;
}

.toolbar-group:last-child {
  border-right: none;
  padding-right: 0;
  margin-right: 0;
}

.toolbar-btn {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 32px;
  height: 32px;
  border: none;
  background: transparent;
  border-radius: 4px;
  cursor: pointer;
  font-size: 14px;
  font-weight: 500;
  color: #374151;
  transition: all 0.2s ease;
  position: relative;
}

.toolbar-btn:hover {
  background: #f3f4f6;
  color: #1f2937;
}

.toolbar-btn.active {
  background: #e5e7eb;
  color: #111827;
}

.toolbar-btn:active {
  transform: scale(0.95);
}

.media-group .toolbar-btn,
.special-group .toolbar-btn {
  font-size: 12px;
  padding: 0 8px;
  width: auto;
}

.special-group .toolbar-btn {
  white-space: nowrap;
  color: #4b5563;
}

/* å“åº”å¼è®¾è®¡ */
@media (max-width: 768px) {
  .editor-toolbar {
    flex-wrap: wrap;
    justify-content: flex-start;
    padding: 6px;
  }
  
  .toolbar-group {
    margin-bottom: 4px;
  }
  
  .special-group {
    flex-wrap: wrap;
    justify-content: flex-start;
    width: 100%;
  }
  
  .special-group .toolbar-btn {
    margin-bottom: 4px;
    font-size: 11px;
  }
  
  .toolbar-btn {
    width: 28px;
    height: 28px;
    font-size: 13px;
  }
}
</style>